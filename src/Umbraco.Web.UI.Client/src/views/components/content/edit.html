<div>

   <umb-load-indicator ng-if="page.loading"></umb-load-indicator>

   <form name="contentForm"
      ng-submit="save()"
      novalidate
      val-form-manager>

      <umb-editor-view ng-if="!page.loading" umb-tabs>

         <umb-editor-header
            menu="page.menu"
            name="content.name"
            tabs="content.tabs"
            hide-icon="true"
            hide-description="true"
            hide-alias="true">
         </umb-editor-header>

         <umb-editor-container>
            <umb-tabs-content class="form-horizontal" view="true">
               <umb-tab id="tab{{tab.id}}" ng-repeat="tab in content.tabs" rel="{{tab.id}}">
                    <div ng-show="tab.id === 0">
                        <div class="umb-package-details">
                            <div class="umb-package-details__main-content">
                                <umb-box>
                                    <umb-box-header title="Links"></umb-box-header>
                                    <umb-box-content class="block-form">
                                        <ul class="nav nav-stacked" style="margin-bottom: 0;">
                                            <li ng-repeat="url in content.urls">
                                                <a href="{{url}}" target="_blank">
                                                    <i class="icon icon-window-popin"></i>
                                                    <span>{{url}}</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </umb-box-content>    
                                </umb-box>
                                <umb-box>
                                    <umb-box-header title="History"></umb-box-header>
                                    <umb-box-content class="block-form" style="position: relative;">

                                        <umb-load-indicator ng-if="loadingAuditTrail"></umb-load-indicator>

                                        <div ng-if="!loadingAuditTrail">
                                            <div class="history-item" ng-repeat="item in auditTrail" ng-class="{'last-history-item': $last}">
                                                <div class="history-row">
                                                    <umb-avatar
                                                        color="secondary"
                                                        size="xs"
                                                        name="{{item.user.name}}"
                                                        img-src="{{item.user.avatars[3]}}"
                                                        img-srcset="{{item.user.avatars[4]}} 2x, {{item.user.avatars[4]}} 3x">
                                                    </umb-avatar>
                                                    <div class="name-date-container">
                                                    <span>{{ item.user.name }}</span>
                                                    <span class="date">{{ item.date }}</span>
                                                    </div>
                                                        <umb-badge
                                                            size="s"
                                                            color="{{item.actionColor}}">
                                                            {{ item.action }}
                                                        </umb-badge>
                                                <span>{{ item.description }}</span>
                                                </div>
                                                <div class="history-line"></div>
                                            </div>

                                            <div class="flex justify-center">
                                                <umb-pagination
                                                    page-number="pagination.pageNumber"
                                                    total-pages="pagination.totalPages"
                                                    on-next="nextPage"
                                                    on-prev="prevPage"
                                                    on-go-to-page="goToPage">
                                                </umb-pagination>
                                            </div>

                                        </div>

                                    </umb-box-content>    
                                </umb-box>           
                            </div>

                            <div class="umb-package-details__sidebar">
                                <umb-box>
                                    <umb-box-header title="Scheduled publish"></umb-box-header>
                                    <umb-box-content class="block-form">
                                        <div class="date-wrapper">
                                            <div class="date-container">
                                                <h2>Publish date</h2>
                                                <h3>October 2016</h3>
                                                <h1>17</h1>
                                                <h3>Wednesday 10:43 PM</h3>
                                            </div>
                                            <div class="date-separate"></div>
                                            <div class="date-container">
                                                <h2>Unpublish date</h2>
                                                <div class="place-holder"></div>
                                                <h4>ADD DATE</h4>
                                            </div>
                                        </div>
                                    </umb-box-content>    
                                </umb-box>
                                <umb-box>
                                    <umb-box-header title="Meta data"></umb-box-header>
                                    <umb-box-content class="block-form">
                                        <umb-control-group label="Created by {{ content.owner.name }} at {{ content.createDate }}"></umb-control-group>
                                        
                                        <umb-control-group label="@content_documentType" description="{{docType.description}}">
                                            <umb-node-preview
                                                icon="docType.icon"
                                                name="docType.name"
                                                allow-open="allowOpen"
                                                on-open="openDocType(docType)">
                                            </umb-node-preview>
                                        </umb-control-group>

                                        <umb-control-group label="@template_template" description="{{template.description}}">
                                            <select
                                                class="input-block-level"
                                                ng-model="content.template"
                                                ng-options="key as value for (key, value) in availableTemplates"
                                                ng-change="updateTemplate(content.template)">
                                            </select>
                                        </umb-control-group>

                                        <umb-control-group label="{{ idSection.name }}">
                                            <div>{{ content.id }}</div>
                                            <small class="muted">{{ content.key }}</small>
                                        </umb-control-group>
                                    </umb-box-content>    
                                </umb-box>
                            </div>
                        </div>
                    </div>

                    <div ng-hide="tab.id === 0">
                        <umb-property ng-repeat="property in tab.properties" property="property">
                        <umb-editor model="property"></umb-editor>
                  </umb-property>
                </div>

                
                  <!-- <pre>{{ tab | json }}</pre> -->

               
               </umb-tab>
            </umb-tabs-content>

         </umb-editor-container>


         <umb-editor-footer>

            <umb-editor-footer-content-left>

               <umb-breadcrumbs
                  ng-if="ancestors && ancestors.length > 0"
                  ancestors="ancestors"
                  entity-type="content">
               </umb-breadcrumbs>

            </umb-editor-footer-content-left>


            <umb-editor-footer-content-right>

               <umb-button
                  ng-if="page.listViewPath"
                  type="link"
                  href="#{{page.listViewPath}}"
                  label="Return to list"
                  label-key="buttons_returnToList">
               </umb-button>

               <umb-button
                  ng-if="!page.isNew && content.allowPreview"
                  type="button"
                  button-style="info"
                  action="preview(content)"
                  label="Preview page"
                  label-key="buttons_showPage">
               </umb-button>

               <umb-button-group
                  ng-if="defaultButton"
                  default-button="defaultButton"
                  sub-buttons="subButtons"
                  state="page.buttonGroupState"
                  direction="up"
                  float="right">
               </umb-button-group>


            </umb-editor-footer-content-right>

         </umb-editor-footer>

      </umb-editor-view>

   </form>
</div>
